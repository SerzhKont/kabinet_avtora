#!/bin/bash -e
#
# Это скрипт-обертка, который запускается от ROOT.

# 1. Задачи от ROOT (запуск SSH)
echo "Running ROOT tasks: Starting SSHD..."
mkdir -p /var/run/sshd
/usr/sbin/sshd -D &

# 2. Передаем управление стандартному entrypoint
# Запускаем его от пользователя 'rails' С СОХРАНЕНИЕМ ОКРУЖЕНИЯ (-p)
# и передаем ему все аргументы (CMD)
echo "Handing over to standard entrypoint as user 'rails'..."
exec su -p rails -c "/rails/bin/docker-entrypoint $@"
