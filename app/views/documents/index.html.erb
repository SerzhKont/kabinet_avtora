<div class="columns is-gap-1">
  <div class="column is-narrow has-border-right">
    <%= render "layouts/sidebar" %>
  </div>
  <div class="column is-10" data-controller="checkbox">
    <div id="notifications">
      <%= render partial: "layouts/notice", locals: { notice: notice } %>
      <%= render partial: "layouts/alert", locals: { alert: alert } %>
    </div>

    <nav class="level">
      <div class="level-left">
        <div class="level-item">
          <%= search_form_for @q, class: "field has-addons" do |f| %>
            <p class="control has-icons-left">
              <%= f.search_field :author_name_or_extracted_code_cont,
                                class: "input", 
                                placeholder: "Знайти по автору або ІПН" %>
              <span class="icon is-small is-left">
                <i class="fa-solid fa-magnifying-glass"></i>
              </span>
            </p>
            <p class="control"><%= f.submit "Пошук", class: "button" %></p>
          <% end %>
        </div>

        <%= link_to new_document_path, class: "button is-primary" do %>
          <span class="icon is-small">
            <i class="fa-solid fa-arrow-up-from-bracket"></i>
          </span>
          <span>Завантажити документи</span>
        <% end %>

        <button
          class="button is-success"
          id="sign-selected-documents"
          data-checkbox-target="signButton"
          disabled
        >
          <span class="icon is-small">
            <i class="fas fa-signature"></i>
          </span>
          <span>Відправити на підпис</span>
        </button>

        <button
          class="button is-danger"
          id="delete-selected-documents"
          data-checkbox-target="deleteButton"
          data-action="click->checkbox#showDeleteModal"
          disabled
        >
          <span class="icon is-small">
            <i class="fas fa-trash"></i>
          </span>
          <span>Видалити обрані</span>
        </button>

        <div
          id="bulk-delete-modal"
          class="modal"
          data-controller="modal"
          data-checkbox-target="deleteModal"
        >
          <div class="modal-background" data-action="click->modal#close"></div>
          <div class="modal-card">
            <header class="modal-card-head">
              <p class="modal-card-title">
                Підтвердіть масове видалення
              </p>
              <button
                class="delete"
                aria-label="Close"
                data-action="click->modal#close"
              ></button>
            </header>

            <section class="modal-card-body">
              <p>
                Ви впевнені, що хочете видалити
                <strong><span id="delete-count" data-checkbox-target="deleteCount">0</span></strong>
                обраних документів?
              </p>
              <p class="has-text-danger mt-3">Цю дію не можна скасувати!</p>
            </section>

            <footer class="modal-card-foot">
              <div class="buttons">
                <%= form_with url: bulk_delete_documents_path, method: :delete, id: "bulk-delete-form", data: { turbo_frame: "documents_table" } do %>
                  <button
                    type="submit"
                    id="confirm-bulk-delete"
                    class="button is-danger"
                    data-action="click->checkbox#confirmBulkDelete"
                  >
                    Так, видалити
                  </button>
                <% end %>
                <button class="button" data-action="click->modal#close">
                  Скасувати
                </button>
              </div>
            </footer>
          </div>
        </div>
      </div>
    </nav>

    <nav class="level is-align-items-baseline">
      <div class="level-left is-align-items-baseline">
        <div class="level-item">
          <div class="buttons has-addons mb-4">
            <%= link_to "Всі",
                        documents_path(params.permit(:q).merge(status: nil)),
                        class: "button is-small #{"is-link" if params[:status].blank?}" %>
            <%= link_to "Є автор",
                        documents_path(params.permit(:q).merge(status: "linked")),
                        class: "button is-small #{"is-success is-selected" if params[:status] == "linked"}" %>
            <%= link_to "Без автора",
                        documents_path(params.permit(:q).merge(status: "unlinked")),
                        class: "button is-small #{"is-danger is-selected" if params[:status] == "unlinked"}" %>
          </div>
        </div>
        <div class="level-item">
          <p class="subtitle is-6">
            <span class="tag is-info is-light">
              Документів обрано:
              <strong><span id="selected-count" data-checkbox-target="selectedCount">0</span></strong>
            </span>
          </p>
        </div>
      </div>
      <div class="level-right is-align-items-baseline">
        <div class="level-item">
          <p class="subtitle is-6">
            Документів на сторінці:&nbsp;
            <%= form_with url: documents_path, method: :get, local: true, data: { turbo_frame: "documents_table" } do %>
              <div class="select">
                <%= select_tag :items, options_for_select([ 25, 50, 100, 200, 500 ], params[:items]&.to_i || 25), onchange: "this.form.submit()", class: "select" %>
              </div>
            <% end %>
          </p>
        </div>
      </div>
    </nav>

    <%= render partial: "table", locals: { documents: @documents, pagy: @pagy } %>
  </div>
</div>
